(this.webpackJsonpprltaskd1=this.webpackJsonpprltaskd1||[]).push([[0],{109:function(e,t,a){"use strict";a.r(t),a.d(t,"history",(function(){return D}));var n=a(0),s=a.n(n),i=a(45),r=a.n(i),o=a(14),c=a(15),l=a(18),d=a(17),u=a(1),h=a(46),f=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)),p=(a(86),a(87),a(42)),v=a(88),m=a(89);a(103);var y=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(o.a)(this,a),n=t.call(this,e);var s=m.parse(n.props.location.search,{ignoreQueryPrefix:!0});return n.surveyUrl=s.survey_url,n.state={encryptedMetadata:s.id,sendingData:"initial",link:void 0},v.isUndefined(n.state.encryptedMetadata)||n.addScript("/PRLtaskd1/external/lab.js",(function(){n.addScript("/PRLtaskd1/script.js")})),n}return Object(c.a)(a,[{key:"packageDataForExport",value:function(e){var t={};return t.encrypted_metadata=this.state.encryptedMetadata,t.taskName=p.taskName,t.taskVersion=p.taskVersion,t.data=this.processLabJsData(e),JSON.stringify(t)}},{key:"processLabJsData",value:function(e){return e}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("message",(function(t){if("labjs.data"===t.data.type){var a=JSON.parse(t.data.json);if((p.debug||f)&&(console.log(a),console.log(e.processLabJsData(a))),f)return void(e.surveyUrl&&e.setState({link:e.surveyUrl}));e.setState({sendingData:"saving"}),e.saveDataWithRetry(a,0)}}))}},{key:"saveDataWithRetry",value:function(e,t){var a=this;t<10?Object(h.a)(this.state.encryptedMetadata,this.packageDataForExport(e)).then((function(){a.setState({link:a.surveyUrl?a.surveyUrl:null,sendingData:"success"})})).catch((function(){setTimeout((function(){return a.saveDataWithRetry(e,t+1)}),1e3)})):this.setState({sendingData:"failed"})}},{key:"addScript",value:function(e,t){var a=document.createElement("script");a.src=e,a.type="module",a.onreadystatechange=t,a.onload=t,document.head.appendChild(a)}},{key:"render",value:function(){var e;switch(this.state.sendingData){case"saving":e=s.a.createElement("h2",null,"Saving data... do not exit window");break;case"failed":e=s.a.createElement("h2",null,"Saving data failed. Please check your internet connection and refresh this page. If you lost connection during the game, you will need to repeat it.");break;default:e=null}return s.a.createElement("div",null,s.a.createElement("div",{className:"container fullscreen","data-labjs-section":"main",style:{visibility:"saving"!==this.state.sendingData?"visible":"hidden"}},s.a.createElement("main",{className:"content-vertical-center content-horizontal-center"})),s.a.createElement("div",{className:"center",style:{visibility:"saving"===this.state.sendingData?"visible":"hidden"}},e))}}]),a}(n.Component),g=function(){return s.a.createElement(u.c,null,s.a.createElement(u.a,{path:"/",exact:!0,component:y}))},k=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(g,null))}}]),a}(n.Component),b=a(23),w=a(3),D=Object(w.a)();console.log("render react"),r.a.render(s.a.createElement(b.a,{history:D,basename:"/PRLtaskd1"},s.a.createElement(k,null)),document.getElementById("root"))},42:function(e){e.exports=JSON.parse('{"taskVersion":"1.0.0","taskName":"prltaskd1","debug":false,"awsLambda":{"saveTaskData":{"host":"de8cnjde61.execute-api.us-east-2.amazonaws.com","path":"/default/saveTaskData"},"fetchLink":{"host":"3pnzb6n9vf.execute-api.us-east-2.amazonaws.com","path":"/default/fetchLink"}}}')},46:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return r}));var n=a(55),s=a(83),i=a(42);function r(t,a){return new Promise((function(r,o){var c=s.stringify({encrypted_metadata:t,data:a}),l={hostname:i.awsLambda.saveTaskData.host,port:443,path:i.awsLambda.saveTaskData.path,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":e.byteLength(c)}},d=n.request(l,(function(e){e.setEncoding("utf8"),e.on("data",(function(){})),e.on("end",r)}));d.on("error",(function(e){i.debug&&(console.log("ERROR:"),console.log(e)),o(e)})),d.write(c),d.end()}))}}).call(this,a(7).Buffer)},48:function(e,t,a){e.exports=a(109)},58:function(e,t){},60:function(e,t){},81:function(e,t){},86:function(e,t,a){},87:function(e,t,a){}},[[48,1,2]]]);
//# sourceMappingURL=main.559c56b5.chunk.js.map